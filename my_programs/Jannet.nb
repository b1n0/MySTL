(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17481,        436]
NotebookOptionsPosition[     17094,        422]
NotebookOutlinePosition[     17432,        437]
CellTagsIndexPosition[     17389,        434]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Ox", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"B", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"A", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "2"]}], 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
        RowBox[{"A", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]], " ", "+", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Ox", "[", 
         RowBox[{"A", ",", " ", "B"}], "]"}], " ", "-", " ", 
        RowBox[{"A", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"A", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dst2", "[", 
    RowBox[{"K_", ",", "L_", ",", "M_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
      RowBox[{"M", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"K", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"L", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ox", "[", 
              RowBox[{"L", ",", "M"}], "]"}], "-", 
             RowBox[{"K", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"K", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"]}]], "-", 
        RowBox[{"r", "[", 
         RowBox[{"L", ",", "M"}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
      RowBox[{"Ox", "[", 
       RowBox[{"A", ",", "B"}], "]"}]}], 
     RowBox[{"r", "[", 
      RowBox[{"A", ",", "B"}], "]"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineX", "[", 
    RowBox[{"A_", ",", " ", "B_", ",", " ", "t_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"B", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"A", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ox", "[", 
       RowBox[{"A", ",", "B"}], "]"}], "+", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"A", ",", "B"}], "]"}], " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"phi", "[", 
           RowBox[{"A", ",", "B"}], "]"}], " ", "+", " ", 
          RowBox[{"t", " ", "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"phi", "[", 
              RowBox[{"B", ",", "A"}], "]"}], " ", "-", " ", 
             RowBox[{"phi", "[", 
              RowBox[{"A", ",", "B"}], "]"}]}], ")"}]}]}], "]"}], ")"}]}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lineY", "[", 
    RowBox[{"A_", ",", " ", "B_", ",", " ", "t_"}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"B", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", 
      RowBox[{"t", " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
         RowBox[{"A", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"A", ",", "B"}], "]"}], " ", "*", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"phi", "[", 
         RowBox[{"A", ",", "B"}], "]"}], " ", "+", " ", 
        RowBox[{"t", " ", "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"phi", "[", 
            RowBox[{"B", ",", "A"}], "]"}], " ", "-", " ", 
           RowBox[{"phi", "[", 
            RowBox[{"A", ",", "B"}], "]"}]}], ")"}]}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"err", " ", "=", " ", 
       RowBox[{
        RowBox[{"dst2", "[", 
         RowBox[{"P1", ",", "P2", ",", "P3"}], "]"}], "*", 
        RowBox[{"dst2", "[", 
         RowBox[{"P2", ",", "P1", ",", "P3"}], "]"}], "*", 
        RowBox[{"dst2", "[", 
         RowBox[{"P3", ",", "P1", ",", "P2"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"err", "\[NotEqual]", "0"}], ",", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"dst2", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "P1", ",", "P2"}], "]"}],
              "==", 
             RowBox[{"dst2", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "P2", ",", "P3"}], "]"}],
              "==", 
             RowBox[{"dst2", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "P1", ",", "P3"}], 
              "]"}]}], " ", "&&", " ", 
            RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "100"}], " ", "&&",
             " ", 
            RowBox[{"0", "\[LessEqual]", "y", "\[LessEqual]", "100"}]}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", " ", "Reals"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fCnt", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"err", "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "/.", 
          RowBox[{"S", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", "P1"}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ro", " ", "=", " ", 
       RowBox[{"N", "[", 
        SqrtBox[
         RowBox[{"dst2", "[", 
          RowBox[{"fCnt", ",", "P1", ",", "P2"}], "]"}]], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Cnt", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fCnt", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"fCnt", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "2"], "-", 
             SuperscriptBox["ro", "2"]}]]}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"len", " ", "=", " ", 
         RowBox[{"ro", " ", "*", " ", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{
              RowBox[{"fCnt", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", 
              RowBox[{"ro", "*", 
               RowBox[{"Sin", "[", "t", "]"}]}]}]], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]}]}], ","}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"param", " ", "=", " ", 
       RowBox[{"ParametricPlot", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lineX", "[", 
              RowBox[{"P1", ",", " ", "P2", ",", " ", "t"}], "]"}], ",", " ", 
             RowBox[{"lineY", "[", 
              RowBox[{"P1", ",", " ", "P2", ",", " ", "t"}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lineX", "[", 
              RowBox[{"P2", ",", " ", "P3", ",", " ", "t"}], "]"}], ",", " ", 
             RowBox[{"lineY", "[", 
              RowBox[{"P2", ",", " ", "P3", ",", " ", "t"}], "]"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lineX", "[", 
              RowBox[{"P1", ",", " ", "P3", ",", " ", "t"}], "]"}], ",", " ", 
             RowBox[{"lineY", "[", 
              RowBox[{"P1", ",", " ", "P3", ",", " ", "t"}], "]"}]}], "}"}]}],
           "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "100"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "100"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"Function", "[", "Pink", "]"}]}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"geom", " ", "=", " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Black", ",", " ", 
          RowBox[{"Circle", "[", 
           RowBox[{"fCnt", ",", "ro"}], "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"param", ",", "geom"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P1", ",", " ", 
       RowBox[{"{", 
        RowBox[{"100", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", "Locator"}],
     "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P2", ",", " ", 
       RowBox[{"{", 
        RowBox[{"50", ",", " ", "100"}], "}"}]}], "}"}], ",", " ", 
     "Locator"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P3", ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", "Locator"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7221781194546647`*^9, 3.722178259648681*^9}, {
   3.722178291822521*^9, 3.72217833534101*^9}, {3.7221783951054287`*^9, 
   3.722178506699812*^9}, {3.7221785441009483`*^9, 3.722178557779731*^9}, 
   3.7221786230804663`*^9, {3.7221787233332*^9, 3.7221787301405897`*^9}, {
   3.7221794097369194`*^9, 3.7221795445596313`*^9}, {3.72217958195577*^9, 
   3.722179591798333*^9}, {3.722179648884598*^9, 3.72217969926548*^9}, {
   3.722179729723222*^9, 3.7221797418779173`*^9}, {3.7221800972532434`*^9, 
   3.7221803546699667`*^9}, {3.7221804373046913`*^9, 3.722180448479331*^9}, {
   3.7221805273388386`*^9, 3.7221806470896883`*^9}, {3.722180685118863*^9, 
   3.7221807937740784`*^9}, {3.7221808680583267`*^9, 3.722180946506814*^9}, {
   3.722183113702721*^9, 3.722183136505025*^9}, {3.7221832112463007`*^9, 
   3.722183214829505*^9}, {3.7221832465243177`*^9, 3.722183441034439*^9}, {
   3.7221834710371513`*^9, 3.7221834792306194`*^9}, {3.722183536478894*^9, 
   3.7221835602692547`*^9}, {3.722183597104228*^9, 3.722183609848957*^9}, {
   3.7221837259685984`*^9, 3.72218373946237*^9}, {3.7221837967556443`*^9, 
   3.7221839339914913`*^9}, {3.7221839680724363`*^9, 
   3.7221840300455513`*^9}, {3.7221842040134993`*^9, 3.722184224407666*^9}, {
   3.722184264037933*^9, 3.7221843422764053`*^9}, {3.722184456098565*^9, 
   3.722184465120837*^9}, {3.7221846615958924`*^9, 3.722184749084896*^9}, {
   3.7221848143116274`*^9, 3.722185122205238*^9}, {3.722185212708414*^9, 
   3.7221852173816814`*^9}, {3.7221853156543026`*^9, 3.722185355075557*^9}, {
   3.722185398973068*^9, 3.7221854169200945`*^9}, {3.722185455179283*^9, 
   3.7221854554853*^9}, {3.722185545331439*^9, 3.7221855744851065`*^9}, {
   3.7221856255920296`*^9, 3.7221856442460966`*^9}, {3.7221857769126782`*^9, 
   3.722185797160836*^9}, {3.7221858448925667`*^9, 3.722186020659607*^9}, {
   3.7221860561086345`*^9, 3.7221860646161194`*^9}, {3.722186130899911*^9, 
   3.7221862300205774`*^9}, {3.7221862680977554`*^9, 3.722186274576126*^9}, {
   3.722186317270568*^9, 3.7221863240059533`*^9}, {3.72218636922254*^9, 
   3.7221863767919726`*^9}, {3.7221864337352295`*^9, 3.722186478933812*^9}, {
   3.722186563521651*^9, 3.722186606261095*^9}, {3.7221866527747555`*^9, 
   3.7221868315089765`*^9}, {3.722186861750706*^9, 3.7221868620187216`*^9}, {
   3.7221868979677773`*^9, 3.722186939681164*^9}, {3.722187048678398*^9, 
   3.7221870616521397`*^9}, {3.7221885287859297`*^9, 
   3.7221885295569735`*^9}, {3.7221885744335403`*^9, 3.722188629520691*^9}, {
   3.722188699819712*^9, 3.722188769056672*^9}, {3.722188820452612*^9, 
   3.722188855017589*^9}, {3.72218894490173*^9, 3.7221889510620823`*^9}, {
   3.7221890804484825`*^9, 3.7221891331744967`*^9}, {3.7221892015084057`*^9, 
   3.722189350033898*^9}, {3.7221893803136296`*^9, 3.72218940846924*^9}, {
   3.7221894694097176`*^9, 3.7221895402957716`*^9}, {3.722189579165995*^9, 
   3.7221896962565513`*^9}, {3.722189862055745*^9, 3.7221898807888165`*^9}, {
   3.722190226808072*^9, 3.7221902459971695`*^9}, {3.7221908878857985`*^9, 
   3.7221908902098665`*^9}, {3.7221909290441847`*^9, 3.722190929958237*^9}, {
   3.7221917701152525`*^9, 3.722192094011776*^9}, {3.7221921621976757`*^9, 
   3.722192164679818*^9}, {3.7221922274084053`*^9, 3.7221923221478243`*^9}, {
   3.7221924359673347`*^9, 3.7221925366440907`*^9}, {3.722192669547688*^9, 
   3.7221928177281637`*^9}, {3.722192873783367*^9, 3.7221931802258925`*^9}, {
   3.7221932188631024`*^9, 3.7221932399823103`*^9}, {3.7221932902721868`*^9, 
   3.7221933647814484`*^9}, {3.722193451932431*^9, 3.722193536578273*^9}, {
   3.722193576708568*^9, 3.7221936268444357`*^9}, {3.722193686755862*^9, 
   3.722193728569254*^9}, {3.722193764049283*^9, 3.7221937932549534`*^9}, {
   3.7221938323311663`*^9, 3.722193879658873*^9}, {3.7221939281456466`*^9, 
   3.722194056694998*^9}, {3.7221941039006977`*^9, 3.722194153262519*^9}, {
   3.7221943227402124`*^9, 3.722194384462743*^9}, {3.722194417506633*^9, 
   3.7221944287522755`*^9}, {3.7221945070617547`*^9, 
   3.7221945090848703`*^9}, {3.722194621129279*^9, 3.722194633999015*^9}, {
   3.7221946715251617`*^9, 3.7221947957112613`*^9}, {3.7221948991531777`*^9, 
   3.722194900029228*^9}, {3.722194962606807*^9, 3.722195014706787*^9}, {
   3.7221950563621693`*^9, 3.7221951227139645`*^9}, {3.722195207473813*^9, 
   3.7221953380332804`*^9}, {3.7221954173578176`*^9, 3.72219542684636*^9}, {
   3.722195530429285*^9, 3.722195579458089*^9}, {3.722195790519161*^9, 
   3.722195886467649*^9}, {3.722196037909311*^9, 3.722196105238162*^9}, {
   3.7221963035285034`*^9, 3.7221963849391603`*^9}, {3.7221964486178017`*^9, 
   3.7221965199948845`*^9}, {3.7221965763061056`*^9, 3.722196672280595*^9}, {
   3.7221969255950837`*^9, 3.7221970409166794`*^9}, {3.7221971499189143`*^9, 
   3.7221972418821745`*^9}, {3.7221973954749594`*^9, 3.722197420376384*^9}, {
   3.7221975554361086`*^9, 3.7221975568511896`*^9}, {3.7221976960131493`*^9, 
   3.722197709445917*^9}, {3.7221977783188567`*^9, 3.7221978637617435`*^9}, {
   3.722197911531476*^9, 3.7221979165067606`*^9}, {3.72219799884847*^9, 
   3.7221979991154857`*^9}},ExpressionUUID->"5aae3a3e-1ee5-4aa6-8dac-\
26992eebc404"],

Cell[BoxData["\.13"], "Input",
 CellChangeTimes->{
  3.722409027233677*^9},ExpressionUUID->"3df728f5-cde6-45a3-9be0-\
2272480d59d7"]
},
WindowSize->{1280, 691},
WindowMargins->{{4, Automatic}, {0, Automatic}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16397, 395, 849, "Input",ExpressionUUID->"5aae3a3e-1ee5-4aa6-8dac-26992eebc404"],
Cell[16958, 417, 132, 3, 31, "Input",ExpressionUUID->"3df728f5-cde6-45a3-9be0-2272480d59d7"]
}
]
*)

